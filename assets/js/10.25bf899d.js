(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{525:function(t,s,a){t.exports=a.p+"assets/img/OCRunner_0.76a8d590.png"},526:function(t,s,a){t.exports=a.p+"assets/img/OCRunner_2.d8eb7d40.png"},527:function(t,s,a){t.exports=a.p+"assets/img/OCRunner_1.6369c65d.png"},551:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),n("h3",{attrs:{id:"ocrunner开发补丁的工作流"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ocrunner开发补丁的工作流"}},[t._v("#")]),t._v(" "),n("a",{attrs:{href:"https://github.com/SilverFruity/OCRunner",target:"_blank",rel:"noopener noreferrer"}},[t._v("OCRunner"),n("OutboundLink")],1),t._v("开发补丁的工作流")]),t._v(" "),n("p",[n("img",{attrs:{src:a(525),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"初衷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初衷"}},[t._v("#")]),t._v(" 初衷")]),t._v(" "),n("p",[t._v("为了能够实现一篇文章的思路：Objective-C源码 -> 二进制补丁文件 ->热更新（具体是哪篇我忘了）。当时刚好开始了"),n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango",target:"_blank",rel:"noopener noreferrer"}},[t._v("oc2mango"),n("OutboundLink")],1),t._v("翻译器的漫漫长路（顺带为了学习编译原理，嘻嘻），等基本完成以后，就开始肝OCRunner：完全兼容struct，enum，系统C函数调用，魔改libffi，生成补丁文件等，尽可能兼容Objective-C，为了做一个直接运行OC的快乐人。")]),t._v(" "),n("h3",{attrs:{id:"各方职责"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#各方职责"}},[t._v("#")]),t._v(" 各方职责")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango/tree/master/oc2mangoLib",target:"_blank",rel:"noopener noreferrer"}},[t._v("oc2mangoLib"),n("OutboundLink")],1),t._v("相当于一个简单的编译器，负责生成语法树")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango/tree/master/oc2mangoLib/PatchFile",target:"_blank",rel:"noopener noreferrer"}},[t._v("ORPatchFile"),n("OutboundLink")],1),t._v("负责将语法树序列化、反序列化和版本判断")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango/tree/master/PatchGenerator",target:"_blank",rel:"noopener noreferrer"}},[t._v("PatchGenerator"),n("OutboundLink")],1),t._v("负责将oc2mangoLib和ORPatchFile的功能整合（以上工具都在"),n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango",target:"_blank",rel:"noopener noreferrer"}},[t._v("oc2mango"),n("OutboundLink")],1),t._v("项目下）")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/SilverFruity/OCRunner",target:"_blank",rel:"noopener noreferrer"}},[t._v("OCRunner"),n("OutboundLink")],1),t._v("负责解释执行语法树")])]),t._v(" "),n("h3",{attrs:{id:"与其他库的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#与其他库的区别"}},[t._v("#")]),t._v(" 与其他库的区别")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("下发二进制补丁文件。增加安全性，减小补丁大小，省去词法分析与语法分析，优化启动时间，可在PatchGenerator阶段进行优化")])]),t._v(" "),n("li",[n("p",[t._v("自定义的Arm64 ABI （可以不使用libffi）")])]),t._v(" "),n("li",[n("p",[t._v("完整的Objective-C语法支持，除去预编译和部分语法")])])]),t._v(" "),n("h2",{attrs:{id:"本地使用ocrunner运行补丁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#本地使用ocrunner运行补丁"}},[t._v("#")]),t._v(" 本地使用OCRunner运行补丁")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/SilverFruity/OCRunner/tree/master/OCRunnerDemo",target:"_blank",rel:"noopener noreferrer"}},[t._v("OCRunnerDemo"),n("OutboundLink")],1),t._v("可以作为整个流程的参照.")]),t._v(" "),n("h3",{attrs:{id:"cocoapods导入ocrunner"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cocoapods导入ocrunner"}},[t._v("#")]),t._v(" Cocoapods导入OCRunner")]),t._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[t._v("pod "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OCRunner'")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#支持所有架构，包含libffi.a")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\npod "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OCRunnerArm64'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#仅支持 arm64和arm64e，没有libffi.a")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("h3",{attrs:{id:"下载-patchgenerator"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下载-patchgenerator"}},[t._v("#")]),t._v(" 下载 "),n("a",{attrs:{href:"https://github.com/SilverFruity/oc2mango/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("PatchGenerator"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("解压PatchGenerato.zip，然后将PatchGenerator保存到/usr/bin/或项目目录下.")]),t._v(" "),n("h3",{attrs:{id:"添加patchgenerator的-run-script"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加patchgenerator的-run-script"}},[t._v("#")]),t._v(" 添加PatchGenerator的 "),n("code",[t._v("Run Script")])]),t._v(" "),n("ol",[n("li",[n("p",[n("strong",[t._v("Project Setting")]),t._v(" -> "),n("strong",[t._v("Build Phases")]),t._v(" -> 左上角的 "),n("code",[t._v("+")]),t._v(" -> "),n("code",[t._v("New Run Script Phase")])])]),t._v(" "),n("li",[n("p",[t._v("PatchGenerator的路径 "),n("strong",[t._v("-files")]),t._v(" Objective-C源文件列表或者文件夹 "),n("strong",[t._v("-refs")]),t._v(" Objective-C头文件列表或者文件夹 "),n("strong",[t._v("-output")]),t._v(" 输出补丁保存的位置")])]),t._v(" "),n("li",[n("p",[t._v("比如OCRunnerDemo中的"),n("code",[t._v("Run Script")])]),t._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SRCROOT")]),t._v("/OCRunnerDemo/PatchGenerator -files "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SRCROOT")]),t._v("/OCRunnerDemo/ViewController1 -refs  "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SRCROOT")]),t._v("/OCRunnerDemo/Scripts.bundle -output "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SRCROOT")]),t._v("/OCRunnerDemo/binarypatch\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])])])]),t._v(" "),n("h3",{attrs:{id:"开发环境下-运行补丁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发环境下-运行补丁"}},[t._v("#")]),t._v(" 开发环境下: 运行补丁")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("将生成的补丁文件作为资源文件添加到项目中")])]),t._v(" "),n("li",[n("p",[t._v("Appdelegate.m")])])]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BOOL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UIApplication "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("application didFinishLaunchingWithOptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NSDictionary "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("launchOptions "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token expression"}},[t._v("DEBUG")])]),t._v("\n    NSString "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("patchFilePath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("NSBundle mainBundle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" pathForResource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"PatchFileName"')]),t._v(" ofType"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("nil"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("else")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// download from server")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("endif")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ORInterpreter excuteBinaryPatchFile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("patchFilePath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" YES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("每次修改文件，记得Command+B，调用Run Scrip，重新生成补丁文件.")])]),t._v(" "),n("h3",{attrs:{id:"正式环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#正式环境"}},[t._v("#")]),t._v(" 正式环境")]),t._v(" "),n("ol",[n("li",[t._v("将补丁上传到服务器")]),t._v(" "),n("li",[t._v("App中下载补丁文件并保存到本地")]),t._v(" "),n("li",[t._v("使用**[ORInterpreter excuteBinaryPatchFile:PatchFilePath]** 执行补丁")])]),t._v(" "),n("h2",{attrs:{id:"使用介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用介绍"}},[t._v("#")]),t._v(" 使用介绍")]),t._v(" "),n("h3",{attrs:{id:"引入结构体、枚举、typedef"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#引入结构体、枚举、typedef"}},[t._v("#")]),t._v(" 引入结构体、枚举、typedef")]),t._v(" "),n("p",[t._v("可以通过修改"),n("strong",[t._v("OCRunnerDemo")]),t._v("中的"),n("strong",[t._v("ViewController1")]),t._v("，运行以下代码.")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将添加一个名为dispatch_once_t的新类型")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" NSInteger dispatch_once_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// link NSLog")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NSString "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" NSUInteger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    UIControlEventTouchDown                                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    UIControlEventTouchDownRepeat                                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    UIControlEventTouchDragInside                                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    UIControlEventTouchDragOutside                                  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    UIControlEventTouchDragEnter                                    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("UIControlEvents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    UIControlEvents events "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UIControlEventTouchDown "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" UIControlEventTouchDownRepeat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" UIControlEventTouchDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"UIControlEventTouchDown"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"enum test: %lu"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br")])]),n("p",[n("strong",[t._v("Tips:")])]),t._v(" "),n("p",[t._v("推荐新建一个文件来放置以上代码，类似于OCRunnerDemo中的UIKitRefrence和GCDRefrence文件，然后使用"),n("strong",[t._v("PatchGenerator")]),t._v("以**-links**的形式加入补丁生成。作者想偷偷懒，不想再去CV了，头文件太多了😭.")]),t._v(" "),n("h3",{attrs:{id:"使用系统内置c函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用系统内置c函数"}},[t._v("#")]),t._v(" 使用系统内置C函数")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//you only need to add the C function declaration in Script.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//link NSLog")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NSString "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//then you can use it in Scrtips.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"test for link function %@"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"xixi"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("p",[t._v("当你运行以上代码时. OCRunner将会使用"),n("code",[t._v("ORSearchedFunction")]),t._v(" 搜索函数的指针.")]),t._v(" "),n("p",[t._v("这个过程的核心实现是 "),n("code",[t._v("SymbolSearch")]),t._v(" (修改自"),n("code",[t._v("fishhook")]),t._v(").")]),t._v(" "),n("p",[t._v("如果搜索到的结果是NULL，OCRunner将会自动在控制台打印如下信息:")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("❕you need add ⬇️ code "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" the application file "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ORSystemFunctionTable reg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"dispatch_source_set_timer"')]),t._v(" pointer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("dispatch_source_set_timer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("h3",{attrs:{id:"修复oc对象-类-方法、添加属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修复oc对象-类-方法、添加属性"}},[t._v("#")]),t._v(" 修复OC对象（类）方法、添加属性")]),t._v(" "),n("blockquote",[n("p",[t._v("小天才英语学习机，不会哪里点哪里")])]),t._v(" "),n("p",[t._v("想修复哪个方法，将改方法实现即可，不用实现其他方法.")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@interface")]),t._v(" ORTestClassProperty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("NSObject\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@property")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nonatomic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("copy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("NSString "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("strTypeProperty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@property")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nonatomic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("weak"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("id weakObjectProperty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@end")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@implementation")]),t._v(" ORTestClassProperty\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("otherMethod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strTypeProperty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"Mango"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NSString "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("testObjectPropertyTest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),t._v(" ORGtestObjectPropertyTest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//方法名前加'ORG'调用原方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),t._v(" otherMethod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strTypeProperty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@end")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("h3",{attrs:{id:"block使用、解决循环引用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#block使用、解决循环引用"}},[t._v("#")]),t._v(" Block使用、解决循环引用")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用于解决循环引用")]),t._v("\n__weak id object "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("NSObject new"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最简block声明")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("a")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br")])]),n("h3",{attrs:{id:"使用gcd"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用gcd"}},[t._v("#")]),t._v(" 使用GCD")]),t._v(" "),n("p",[t._v("本质就是 "),n("strong",[t._v("使用系统内置C函数")]),t._v("，通过"),n("strong",[t._v("GCDRefrences")]),t._v("文件添加，GCD相关的函数声明以及typedef皆在其中.")]),t._v(" "),n("p",[t._v("比如:")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// link dispatch_sync")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch_sync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dispatch_queue_t queue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatch_block_t block"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  dispatch_queue_t queue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch_queue_create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.plliang19.mango"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("DISPATCH_QUEUE_SERIAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch_async")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("queue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   \t"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("completion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"success"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("h3",{attrs:{id:"使用内联函数、预编译函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用内联函数、预编译函数"}},[t._v("#")]),t._v(" 使用内联函数、预编译函数")]),t._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objc"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 内联函数：在补丁中，添加一个全局函数中即可，比如UIKitRefrences中的CGRectMake")]),t._v("\nCGRect "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("CGRectMake")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CGFloat x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CGFloat y"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CGFloat width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CGFloat height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  CGRect rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" y"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" rect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 预编译函数：需要在App中预埋")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MFScopeChain top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" setValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MFValue valueWithBlock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dispatch_once_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("onceTokenPtr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                                                  dispatch_block_t _Nullable handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch_once")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onceTokenPtr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" withIndentifier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"dispatch_once"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("h3",{attrs:{id:"如何确定补丁中是否包含源文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何确定补丁中是否包含源文件"}},[t._v("#")]),t._v(" 如何确定补丁中是否包含源文件")]),t._v(" "),n("p",[n("img",{attrs:{src:a(526),alt:""}})]),t._v(" "),n("p",[t._v("查看Run Script打印的 "),n("strong",[t._v("InputFiles")]),t._v(" 中是否包含源文件.")]),t._v(" "),n("h2",{attrs:{id:"性能测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#性能测试"}},[t._v("#")]),t._v(" 性能测试")]),t._v(" "),n("p",[n("img",{attrs:{src:a(527),alt:""}})]),t._v(" "),n("p",[t._v("根据已知数据，OCRunner的补丁加载速度是JSPatch的20倍+，随着补丁大小的不断增加，这个倍数会不断增加。运行速度和内存占用与MangoFix差距不大。内存占用方面应该会更优，OCRunner中MFValue的值采用malloc来复制值，不会有多个类型的实例变量。")]),t._v(" "),n("h2",{attrs:{id:"目前的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目前的问题"}},[t._v("#")]),t._v(" 目前的问题")]),t._v(" "),n("ol",[n("li",[t._v("指针与乘号识别冲突问题，衍生的问题：类型转换等等")]),t._v(" "),n("li",[t._v("不支持static、inline函数声明")]),t._v(" "),n("li",[t._v("不支持C数组声明:  type a[]和type a[2]，以及 value = { 0 , 0 , 0 , 0 } 这种表达式")]),t._v(" "),n("li",[t._v("不支持 ‘->’ 操作符号")]),t._v(" "),n("li",[t._v("不支持C函数替换")])]),t._v(" "),n("h2",{attrs:{id:"支持语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#支持语法"}},[t._v("#")]),t._v(" 支持语法")]),t._v(" "),n("ol",[n("li",[t._v("类声明与实现，支持分类写法")]),t._v(" "),n("li",[t._v("Protocol")]),t._v(" "),n("li",[t._v("Block语法")]),t._v(" "),n("li",[t._v("结构体、枚举、typedef")]),t._v(" "),n("li",[t._v("使用函数声明，链接系统函数指针")]),t._v(" "),n("li",[t._v("全局函数")]),t._v(" "),n("li",[t._v("多参数调用（方法和函数）")]),t._v(" "),n("li",[n("strong",[t._v("*")]),t._v("、"),n("strong",[t._v("&")]),t._v("  (指针操作)")]),t._v(" "),n("li",[t._v("变量static关键字")]),t._v(" "),n("li",[t._v("NSArray: @[value1, value2]，NSDictionary: @{ key: value },  NSNumer:  @(value)")]),t._v(" "),n("li",[t._v("NSArray取值和NSDictionary取值和赋值语法，id value = a[var];  a[var] = value;")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://baike.baidu.com/item/%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/4752611?fr=aladdin",target:"_blank",rel:"noopener noreferrer"}},[t._v("运算符，除去'->'皆已实现"),n("OutboundLink")],1)])]),t._v(" "),n("p",[t._v("... 等")]),t._v(" "),n("p",[t._v("想到了再加吧😂")]),t._v(" "),n("h2",{attrs:{id:"目标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目标"}},[t._v("#")]),t._v(" 目标")]),t._v(" "),n("ul",[n("li",[t._v("完善当前的语法支持")]),t._v(" "),n("li",[t._v("更多的单元测试覆盖（尽管目前显示是84%）")]),t._v(" "),n("li",[t._v("PatchGenerator阶段进行优化：未被调用的函数声明、结构体、枚举等，不会在补丁中，减少包大小以及加载时间等")]),t._v(" "),n("li",[t._v("尝试Swift热更新（新建库吧，哈哈）")])])])}),[],!1,null,null,null);s.default=e.exports}}]);